---
displayNumber: 147
status: open
priority: 2
createdAt: 2026-02-06T00:28:24.733088+00:00
updatedAt: 2026-02-06T00:28:24.733088+00:00
---

# safety: replace std::process::exit(1) with graceful error propagation

src/main.rs:196 calls std::process::exit(1) when the daemon fails to bind to a port that is already in use. This immediately terminates the process without running Drop destructors, which means:

* Open file handles may not be flushed
* Temporary files may not be cleaned up
* Tokio runtime may not shut down gracefully
* Any pending I/O operations are abandoned

The return Err(e.into()) on the next line already handles the error properly — the process::exit(1) branch is specifically for the address-in-use case to print a helpful message, but it could achieve the same effect without bypassing cleanup.

Proposal:

1. Replace std::process::exit(1) with normal error propagation that still prints the helpful message before returning the error
1. Enable clippy::exit lint (exit = “warn” in Cargo.toml \[lints.clippy\]) to prevent future process::exit() calls from being introduced
