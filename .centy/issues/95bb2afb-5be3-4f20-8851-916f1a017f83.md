---
displayNumber: 111
status: open
priority: 2
createdAt: 2026-01-09T18:53:26.631201+00:00
updatedAt: 2026-01-09T18:53:26.631201+00:00
---

# Add lint and build checks in pre-push hook

Add a pre-push git hook that runs lint (clippy) and build checks before code is pushed to the remote repository. This ensures broken or non-compliant code doesn’t reach CI, saving resources and providing faster feedback.

## Current State

The project uses `cargo-husky` for git hooks with the following configuration in `Cargo.toml`:

````toml
cargo-husky = { version = "1", default-features = false, features = ["precommit-hook", "user-hooks"] }
````

Currently, only a pre-commit hook exists that runs clippy:

````sh
#!/bin/sh
set -e
echo "Running Clippy with pedantic lints..."
cargo clippy --all-targets -- -D warnings
````

## Problem

While clippy runs on commit, there’s no build verification before pushing. This means:

* Broken builds can be pushed to remote and fail CI
* Time is wasted waiting for CI to catch compilation errors
* Team members may pull broken code

## Solution

1. Add the `prepush-hook` feature to cargo-husky in `Cargo.toml`:
   
   ````toml
   cargo-husky = { version = "1", default-features = false, features = ["precommit-hook", "prepush-hook", "user-hooks"] }
   ````

1. Create a `.cargo-husky/hooks/pre-push` script:
   
   ````sh
   #!/bin/sh
   set -e
   
   echo "Pre-push checks starting..."
   
   echo "[1/2] Running Clippy..."
   cargo clippy --all-targets -- -D warnings
   
   echo "[2/2] Building project..."
   cargo build --all-targets
   
   echo "Pre-push checks passed!"
   ````

1. Make the script executable and commit it to version control

## Considerations

* **Test suite**: Consider whether to add `cargo test` to pre-push. This may be slow for large test suites but catches more issues.
* **Release build**: Could optionally add `cargo build --release` check, but this significantly increases push time.
* **Feature flags**: May want to test with different feature combinations.

## Acceptance Criteria

* [ ] `prepush-hook` feature added to cargo-husky in Cargo.toml
* [ ] Pre-push hook script created in `.cargo-husky/hooks/pre-push`
* [ ] Pre-push hook runs clippy with `-D warnings`
* [ ] Pre-push hook runs `cargo build --all-targets`
* [ ] Hook prevents push if either check fails
* [ ] Documentation updated if necessary
