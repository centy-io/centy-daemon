---
displayNumber: 161
status: open
priority: 1
createdAt: 2026-02-10T14:36:26.127204+00:00
updatedAt: 2026-02-10T14:41:22.138423+00:00
---

# Structured error responses: replace plain string errors with JSON objects

Currently, all gRPC response error fields are plain strings (e.g., 'Issue not found: Issue 01eef871-8fde-45b5-b330-571673d84e6a not found'). This makes it hard for clients to parse, display, or act on errors programmatically.

## Proposed Format

Each error string should be a JSON-serialized object with the following shape:

```json
{
  "cwd": "/path/to/project",
  "logs": "~/.centy/logs/centy-daemon.log",
  "messages": [
    {
      "message": "Issue not found",
      "tip": "Check that the issue ID or display number is correct, or run 'centy list issues' to see available issues",
      "code": "ISSUE_NOT_FOUND"
    }
  ]
}
```

### Fields

- **cwd**: The project path as sent by the client (CLI/app) in the request â€” echoed back in the error response for context
- **logs**: The path to the daemon log file (default: `~/.centy/logs/centy-daemon.log`) so clients can point users to logs for debugging
- **messages**: Array of error message objects (supports multiple errors per response)
  - **message**: Human-readable error description
  - **tip**: Optional actionable suggestion for the user to resolve the error
  - **code**: Machine-readable error code for programmatic handling

## Scope

This affects all `string error` fields across all proto response types (~80+ occurrences in centy.proto). The error string will contain a JSON-serialized version of this object.

## Key Areas to Update

1. **Proto layer**: All response handlers in `src/server/handlers/` that set the `error` field
2. **Error types**: All `thiserror` enums (`ItemError`, `IssueError`, `PrError`, `HookError`, `SearchError`, etc.) should produce structured output
3. **Resolve functions**: `src/server/resolve.rs` - format_err calls
4. **Pre-hook errors**: Hook failure strings in handler pre-hook checks
5. **Client SDK**: `DaemonResponseError` on the client side should parse the JSON object
