---
displayNumber: 196
status: in-progress
priority: 2
createdAt: 2026-02-15T21:03:42.171830+00:00
updatedAt: 2026-02-15T21:06:10.429292+00:00
---

# Unify duplicate logic for all item types (static and custom)

The duplicate operation exists only for issues and docs but not in the generic layer. We should add it to the generic layer and route all types through it.

## Current state

* **Generic**: No `generic_duplicate()` exists
* **Issues**: `duplicate_issue()` in `src/item/entities/issue/crud.rs` — creates copy with new UUID and display number
* **Docs**: `duplicate_doc()` in `src/item/entities/doc/crud.rs` — creates copy with “-copy” suffix slug and fresh timestamps

gRPC handlers:

* No unified `item_duplicate.rs` exists
* `issue_duplicate.rs` → calls `issue::duplicate_issue()`
* `doc_duplicate.rs` → calls `doc::duplicate_doc()`

## Goal

1. Create `generic_duplicate()` in `src/item/generic/storage.rs`
1. Remove `duplicate_issue()` and `duplicate_doc()` type-specific implementations
1. Create unified `DuplicateItem` gRPC handler in `item_duplicate.rs`
1. `DuplicateIssue` and `DuplicateDoc` handlers should route through the unified duplicate layer
1. ID generation for the copy should be handled generically: new UUID for UUID-identified types, “-copy” suffix for slug-identified types
1. Display number assignment for the copy should use `config.features.display_number`

## Files involved

* `src/item/generic/storage.rs` — add `generic_duplicate()` (new)
* `src/item/entities/issue/crud.rs` — `duplicate_issue()` to remove
* `src/item/entities/doc/crud.rs` — `duplicate_doc()` to remove
* `src/server/handlers/item_duplicate.rs` — new unified handler
* `src/server/handlers/issue_duplicate.rs` — to redirect to unified
* `src/server/handlers/doc_duplicate.rs` — to redirect to unified
