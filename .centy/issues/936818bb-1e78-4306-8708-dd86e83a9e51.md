---
displayNumber: 148
status: open
priority: 3
createdAt: 2026-02-06T00:28:29.040869+00:00
updatedAt: 2026-02-06T00:28:29.040869+00:00
---

# lint: re-evaluate allowed integer cast lints for potential silent truncation

Three Clippy lints related to integer casting are currently allowed in Cargo.toml:

cast_possible_truncation = “allow”
cast_possible_wrap = “allow”
cast_sign_loss = “allow”

These lints are disabled to avoid noise, but each suppresses detection of a class of bug that could lead to panics or logic errors in a long-running daemon:

* cast_possible_truncation — u64 as u32 silently discards high bits. If a value exceeds u32::MAX, it silently wraps, potentially causing index panics or corrupt data downstream.
* cast_possible_wrap — u64 as i64 can produce negative values for large unsigned numbers, causing unexpected comparison results or panics in code that assumes non-negative values.
* cast_sign_loss — i64 as u64 on a negative value produces a very large number, which could cause out-of-memory panics if used as an allocation size or index.

Proposal:

1. Audit the codebase for all ‘as’ casts that these lints would flag
1. For each cast, determine if truncation/wrap/sign-loss is possible given the domain constraints
1. Replace dangerous casts with safe alternatives like u32::try_from(big_value).map_err(|\_\| Error::Overflow)?
1. Re-enable the lints at warn level and add targeted #\[allow\] with justification comments where truncation is intentional
